<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><meta http-equiv=x-ua-compatible content="IE=edge, chrome=1"><title>pandas合并表格与索引设置 - pujic</title><meta name=Description content><meta property="og:title" content="pandas合并表格与索引设置"><meta property="og:description" content="当我们在做数据分析或者数据挖掘的时候难免会遇到需要合并多个表格的情况，在pandas中要连接表格的姿势非常之多，合适的场景下先择合适的方案将加快我们数据处理的过程。
以下案例均为实际数据处理场景中遇到的问题简化而来。
注意：在所有的数据处理文章中，我并不会讲解函数的所有参数，也不会深入讲解函数的原理，如果想了解该函数更详细的内容建议阅读官方文档"><meta property="og:type" content="article"><meta property="og:url" content="http://example.org/posts/pandas%E8%BF%9E%E6%8E%A5%E8%A1%A8%E6%A0%BC/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-03-09T19:25:15+00:00"><meta property="article:modified_time" content="2021-03-09T19:25:15+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="pandas合并表格与索引设置"><meta name=twitter:description content="当我们在做数据分析或者数据挖掘的时候难免会遇到需要合并多个表格的情况，在pandas中要连接表格的姿势非常之多，合适的场景下先择合适的方案将加快我们数据处理的过程。
以下案例均为实际数据处理场景中遇到的问题简化而来。
注意：在所有的数据处理文章中，我并不会讲解函数的所有参数，也不会深入讲解函数的原理，如果想了解该函数更详细的内容建议阅读官方文档"><meta name=application-name content="pujic"><meta name=apple-mobile-web-app-title content="pujic"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel=icon href=https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/favicon.ico><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=http://example.org/posts/pandas%E8%BF%9E%E6%8E%A5%E8%A1%A8%E6%A0%BC/><link rel=prev href=http://example.org/posts/pandas%E8%AF%BB%E5%8F%96%E5%A4%A7%E6%96%87%E4%BB%B6%E7%AD%9B%E9%80%89%E6%95%B0%E6%8D%AE/><link rel=next href=http://example.org/posts/pandas%E6%95%B0%E6%8D%AE%E8%81%9A%E5%90%88/><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"pandas合并表格与索引设置","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"http:\/\/example.org\/posts\/pandas%E8%BF%9E%E6%8E%A5%E8%A1%A8%E6%A0%BC\/"},"genre":"posts","keywords":"数据处理","wordcount":2396,"url":"http:\/\/example.org\/posts\/pandas%E8%BF%9E%E6%8E%A5%E8%A1%A8%E6%A0%BC\/","datePublished":"2021-03-09T19:25:15+00:00","dateModified":"2021-03-09T19:25:15+00:00","publisher":{"@type":"Organization","name":"普吉春"},"author":{"@type":"Person","name":"普吉春"},"description":""}</script></head><body header-desktop=fixed header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":""==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:""==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title=pujic><img class="lazyload logo" src=/svg/loading.min.svg data-src=https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/favicon.png data-srcset="https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/favicon.png, https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/favicon.png 1.5x, https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/favicon.png 2x" data-sizes=auto alt=https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/favicon.png title=https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/favicon.png><span id=id-1 class=typeit></span></a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>所有文章 </a><a class=menu-item href=/tags/>标签 </a><a class=menu-item href=/categories/>分类 </a><a class=menu-item href=/about/>关于 </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder=搜索文章标题或内容... id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=搜索><i class="fas fa-search fa-fw"></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=清空><i class="fas fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin"></i></span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题><i class="fas fa-adjust fa-fw"></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title=pujic><img class="lazyload logo" src=/svg/loading.min.svg data-src=https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/favicon.png data-srcset="https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/favicon.png, https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/favicon.png 1.5x, https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/favicon.png 2x" data-sizes=auto alt=https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/favicon.png title=https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/favicon.png><span id=id-2 class=typeit></span></a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder=搜索文章标题或内容... id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=搜索><i class="fas fa-search fa-fw"></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=清空><i class="fas fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin"></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>取消</a></div><a class=menu-item href=/posts/ title>所有文章</a><a class=menu-item href=/tags/ title>标签</a><a class=menu-item href=/categories/ title>分类</a><a class=menu-item href=/about/ title>关于</a><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题>
<i class="fas fa-adjust fa-fw"></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>目录</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animated flipInX">pandas合并表格与索引设置</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=http://pujichun.ink title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw"></i>普吉春</a></span>&nbsp;<span class=post-category>收录于 <a href=/categories/%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86/><i class="far fa-folder fa-fw"></i>数据处理</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2021-03-09>2021-03-09</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;约 2396 字&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;预计阅读 5 分钟&nbsp;</div></div><div class="details toc" id=toc-static kept><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fas fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#merge>merge</a><ul><li><ul><li><a href=#合并维度相同的表>合并维度相同的表</a></li><li><a href=#合并维度不同的表>合并维度不同的表</a></li><li><a href=#以多个列为基准进行合并>以多个列为基准进行合并</a></li></ul></li></ul></li><li><a href=#concat>concat</a><ul><li><ul><li><a href=#纵向合并>纵向合并</a></li><li><a href=#横向合并>横向合并</a></li></ul></li></ul></li><li><a href=#append>append</a></li><li><a href=#总结>总结</a></li></ul></nav></div></div><div class=content id=content><p>当我们在做数据分析或者数据挖掘的时候难免会遇到需要合并多个表格的情况，在pandas中要连接表格的姿势非常之多，合适的场景下先择合适的方案将加快我们数据处理的过程。</p><p>以下案例均为实际数据处理场景中遇到的问题简化而来。</p><p><strong>注意：在所有的数据处理文章中，我并不会讲解函数的所有参数，也不会深入讲解函数的原理，如果想了解该函数更详细的内容建议阅读官方文档</strong></p><h2 id=merge>merge</h2><h4 id=合并维度相同的表>合并维度相同的表</h4><p>假设有如下两个表格<code>df1</code>和<code>df2</code>，其中<code>A</code>列表示不同的学生，<code>B</code>列和<code>C</code>列表示改学生对应的科目的成绩，现在需要将两个表格进行合并得到每位学生的平均成绩。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pandas</span> <span class=k>as</span> <span class=nn>pd</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>df1</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;A&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;a&#34;</span><span class=p>,</span> <span class=s2>&#34;b&#34;</span><span class=p>,</span> <span class=s2>&#34;c&#34;</span><span class=p>,</span> <span class=s2>&#34;d&#34;</span><span class=p>,</span> <span class=s2>&#34;e&#34;</span><span class=p>,</span> <span class=s2>&#34;f&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;B&#34;</span><span class=p>:</span> <span class=p>[</span><span class=mi>56</span><span class=p>,</span> <span class=mi>18</span><span class=p>,</span> <span class=mi>67</span><span class=p>,</span> <span class=mi>98</span><span class=p>,</span> <span class=mi>66</span><span class=p>,</span> <span class=mi>82</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span><span class=line><span class=cl><span class=n>df2</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;A&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;f&#34;</span><span class=p>,</span> <span class=s2>&#34;d&#34;</span><span class=p>,</span> <span class=s2>&#34;e&#34;</span><span class=p>,</span> <span class=s2>&#34;c&#34;</span><span class=p>,</span> <span class=s2>&#34;a&#34;</span><span class=p>,</span> <span class=s2>&#34;b&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;C&#34;</span><span class=p>:</span> <span class=p>[</span><span class=mi>78</span><span class=p>,</span> <span class=mi>47</span><span class=p>,</span> <span class=mi>90</span><span class=p>,</span> <span class=mi>81</span><span class=p>,</span> <span class=mi>46</span><span class=p>,</span> <span class=mi>79</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><p><code>df1</code>、<code>df2</code>数据如下</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223224.png data-srcset="https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223224.png, https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223224.png 1.5x, https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223224.png 2x" data-sizes=auto alt=https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223224.png title=https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223224.png></p><p>因为这个问题不只是一个简答的堆叠或绑定，这是一个合并排序的过程，所以需要使用pandas中的<code>merge</code>函数</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>pd</span><span class=o>.</span><span class=n>merge</span><span class=p>(</span><span class=n>df1</span><span class=p>,</span> <span class=n>df2</span><span class=p>,</span> <span class=n>on</span><span class=o>=</span><span class=s2>&#34;A&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>计算结果如下</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223241.png data-srcset="https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223241.png, https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223241.png 1.5x, https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223241.png 2x" data-sizes=auto alt=https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223241.png title=https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223241.png></p><p>结算结果明显是一个<code>Series</code>，但是通过缩影来找值实在是不方便，我希望可以直接出现人名对应着成绩的数据形式</p><p>先将结果的值赋给一个变量</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>s</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>merge</span><span class=p>(</span><span class=n>df1</span><span class=p>,</span> <span class=n>df2</span><span class=p>,</span> <span class=n>on</span><span class=o>=</span><span class=s2>&#34;A&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>然后设置索引的值</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>s</span><span class=o>.</span><span class=n>index</span> <span class=o>=</span> <span class=n>df1</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span>
</span></span></code></pre></td></tr></table></div></div><p>那么我还想给<code>s</code>设置一个<code>name</code>因为可能还需要和其他表的数据进行合并进行计算</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>s</span><span class=o>.</span><span class=n>name</span> <span class=o>=</span> <span class=s2>&#34;平均成绩&#34;</span>
</span></span></code></pre></td></tr></table></div></div><p><code>merge</code>函数有一个参数<code>how</code>，指的是合并(连接)的方式：inner(内连接)，left(左外连接)，right(右外连接)，outer(全外连接)，默认为inner。</p><ul><li>inner只返回两个表中连接字段相等的行</li><li>left返回包括左表中的所有记录和右表中连接字段相等的行</li><li>outer和inner相反，right和left相反</li></ul><h4 id=合并维度不同的表>合并维度不同的表</h4><p>如果我们需要计算<code>B</code>、<code>C</code>科目的平均成绩，但是如果<code>C</code>科目成绩小于60的同学计算平均成绩的时候不考虑<code>C</code>科目的平均成绩。这样的情况下我们最好是不要先进行表的合并操作，虽然可以先将表合并后再按<code>C</code>科目的成绩进行计算，但是这样会多出很多的Python代码，因为pandas是C写的Python库，所以在操作数据的时候能不用Python中的语法就不要使用，我们可以先对<code>df</code>中的数据进行筛选，然后合并后计算的工作pandas自己就帮我们完成了</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pandas</span> <span class=k>as</span> <span class=nn>pd</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>df1</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;A&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;a&#34;</span><span class=p>,</span> <span class=s2>&#34;b&#34;</span><span class=p>,</span> <span class=s2>&#34;c&#34;</span><span class=p>,</span> <span class=s2>&#34;d&#34;</span><span class=p>,</span> <span class=s2>&#34;e&#34;</span><span class=p>,</span> <span class=s2>&#34;f&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;B&#34;</span><span class=p>:</span> <span class=p>[</span><span class=mi>56</span><span class=p>,</span> <span class=mi>18</span><span class=p>,</span> <span class=mi>67</span><span class=p>,</span> <span class=mi>98</span><span class=p>,</span> <span class=mi>66</span><span class=p>,</span> <span class=mi>82</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span><span class=line><span class=cl><span class=n>df2</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;A&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;f&#34;</span><span class=p>,</span> <span class=s2>&#34;d&#34;</span><span class=p>,</span> <span class=s2>&#34;e&#34;</span><span class=p>,</span> <span class=s2>&#34;c&#34;</span><span class=p>,</span> <span class=s2>&#34;a&#34;</span><span class=p>,</span> <span class=s2>&#34;b&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;C&#34;</span><span class=p>:</span> <span class=p>[</span><span class=mi>78</span><span class=p>,</span> <span class=mi>47</span><span class=p>,</span> <span class=mi>90</span><span class=p>,</span> <span class=mi>81</span><span class=p>,</span> <span class=mi>46</span><span class=p>,</span> <span class=mi>79</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>df2</span> <span class=o>=</span> <span class=n>df2</span><span class=p>[</span><span class=n>df2</span><span class=p>[</span><span class=s2>&#34;C&#34;</span><span class=p>]</span><span class=o>&gt;</span><span class=mi>60</span><span class=p>]</span>
</span></span></code></pre></td></tr></table></div></div><p><code>df1</code>、<code>df2</code>数据如下</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223302.png data-srcset="https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223302.png, https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223302.png 1.5x, https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223302.png 2x" data-sizes=auto alt=https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223302.png title=https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223302.png></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>pd</span><span class=o>.</span><span class=n>merge</span><span class=p>(</span><span class=n>df1</span><span class=p>,</span> <span class=n>df2</span><span class=p>,</span> <span class=n>on</span><span class=o>=</span><span class=s2>&#34;A&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>连接结果如下</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223317.png data-srcset="https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223317.png, https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223317.png 1.5x, https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223317.png 2x" data-sizes=auto alt=https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223317.png title=https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223317.png></p><p>得到的结果维度丢失了，这种情况下直接使用<code>merge</code>是有问题的，因为<code>merge</code>默认连接方式是<code>inner</code>，所以只能返回<code>A</code>字段相等的行，所以需要使用<code>left</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>pd</span><span class=o>.</span><span class=n>merge</span><span class=p>(</span><span class=n>df1</span><span class=p>,</span> <span class=n>df2</span><span class=p>,</span> <span class=n>on</span><span class=o>=</span><span class=s2>&#34;A&#34;</span><span class=p>,</span> <span class=n>how</span><span class=o>=</span><span class=s2>&#34;left&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>连接结果如下</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223339.png data-srcset="https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223339.png, https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223339.png 1.5x, https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223339.png 2x" data-sizes=auto alt=https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223339.png title=https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223339.png></p><p>然后我们就可以直接求均值了，因为pandas够聪明，在计算均值的时候如果有值，那么这个值就不会被带入计算</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>pd</span><span class=o>.</span><span class=n>merge</span><span class=p>(</span><span class=n>df1</span><span class=p>,</span> <span class=n>df2</span><span class=p>,</span> <span class=n>on</span><span class=o>=</span><span class=s2>&#34;A&#34;</span><span class=p>,</span> <span class=n>how</span><span class=o>=</span><span class=s2>&#34;left&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>计算结果如下图</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20210311111351.png data-srcset="https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20210311111351.png, https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20210311111351.png 1.5x, https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20210311111351.png 2x" data-sizes=auto alt=https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20210311111351.png title=https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20210311111351.png></p><h4 id=以多个列为基准进行合并>以多个列为基准进行合并</h4><p>以多个列为基准进行合并，那么只需要将<code>merge</code>函数的<code>on</code>参数值指定为列表</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pandas</span> <span class=k>as</span> <span class=nn>pd</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>df1</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;A&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;a&#34;</span><span class=p>,</span> <span class=s2>&#34;b&#34;</span><span class=p>,</span> <span class=s2>&#34;c&#34;</span><span class=p>,</span> <span class=s2>&#34;d&#34;</span><span class=p>,</span> <span class=s2>&#34;e&#34;</span><span class=p>,</span> <span class=s2>&#34;f&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;B&#34;</span><span class=p>:</span> <span class=p>[</span><span class=mi>97</span><span class=p>,</span> <span class=mi>98</span><span class=p>,</span> <span class=mi>99</span><span class=p>,</span> <span class=mi>100</span><span class=p>,</span> <span class=mi>101</span><span class=p>,</span> <span class=mi>102</span><span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;C&#34;</span><span class=p>:</span> <span class=p>[</span><span class=mi>56</span><span class=p>,</span> <span class=mi>18</span><span class=p>,</span> <span class=mi>67</span><span class=p>,</span> <span class=mi>98</span><span class=p>,</span> <span class=mi>66</span><span class=p>,</span> <span class=mi>82</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span><span class=line><span class=cl><span class=n>df2</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;A&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;f&#34;</span><span class=p>,</span> <span class=s2>&#34;d&#34;</span><span class=p>,</span> <span class=s2>&#34;e&#34;</span><span class=p>,</span> <span class=s2>&#34;c&#34;</span><span class=p>,</span> <span class=s2>&#34;a&#34;</span><span class=p>,</span> <span class=s2>&#34;d&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;B&#34;</span><span class=p>:</span> <span class=p>[</span><span class=mi>102</span><span class=p>,</span> <span class=mi>122</span><span class=p>,</span> <span class=mi>101</span><span class=p>,</span> <span class=mi>99</span><span class=p>,</span> <span class=mi>97</span><span class=p>,</span> <span class=mi>100</span><span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;D&#34;</span><span class=p>:</span> <span class=p>[</span><span class=mi>78</span><span class=p>,</span> <span class=mi>47</span><span class=p>,</span> <span class=mi>90</span><span class=p>,</span> <span class=mi>81</span><span class=p>,</span> <span class=mi>46</span><span class=p>,</span> <span class=mi>79</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><p><img class=lazyload src=/svg/loading.min.svg data-src=https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223357.png data-srcset="https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223357.png, https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223357.png 1.5x, https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223357.png 2x" data-sizes=auto alt=https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223357.png title=https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223357.png></p><p>以上面的表格为例，要合并<code>df1</code>和<code>df2</code>，并且要<code>df1</code>和<code>df2</code>中的<code>A</code>、<code>B</code>列能够对上，其实就是一个合并筛选数据的操作，因此合并方式默认为<code>inner</code>就可以</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>pd</span><span class=o>.</span><span class=n>merge</span><span class=p>(</span><span class=n>df1</span><span class=p>,</span> <span class=n>df2</span><span class=p>,</span> <span class=n>on</span><span class=o>=</span><span class=p>[</span><span class=s2>&#34;A&#34;</span><span class=p>,</span> <span class=s2>&#34;B&#34;</span><span class=p>])</span>
</span></span></code></pre></td></tr></table></div></div><p><img class=lazyload src=/svg/loading.min.svg data-src=https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223416.png data-srcset="https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223416.png, https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223416.png 1.5x, https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223416.png 2x" data-sizes=auto alt=https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223416.png title=https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223416.png></p><h2 id=concat>concat</h2><h4 id=纵向合并>纵向合并</h4><p>在https://mp.weixin.qq.com/s/A76oeBfjuUCNuVhQgAzSgA一文中就涉及了表格的合并操作，这种合并相当于堆叠，<code>concat</code>函数中要连接的表格需要放到序列中</p><p>改变一下数据，现在是想要像<code>df1</code>中补充数据</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pandas</span> <span class=k>as</span> <span class=nn>pd</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>df1</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;A&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;a&#34;</span><span class=p>,</span> <span class=s2>&#34;b&#34;</span><span class=p>,</span> <span class=s2>&#34;c&#34;</span><span class=p>,</span> <span class=s2>&#34;d&#34;</span><span class=p>,</span> <span class=s2>&#34;e&#34;</span><span class=p>,</span> <span class=s2>&#34;f&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;B&#34;</span><span class=p>:</span> <span class=p>[</span><span class=mi>56</span><span class=p>,</span> <span class=mi>18</span><span class=p>,</span> <span class=mi>67</span><span class=p>,</span> <span class=mi>98</span><span class=p>,</span> <span class=mi>66</span><span class=p>,</span> <span class=mi>82</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>df2</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;A&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;g&#34;</span><span class=p>,</span> <span class=s2>&#34;h&#34;</span><span class=p>,</span> <span class=s2>&#34;i&#34;</span><span class=p>,</span> <span class=s2>&#34;j&#34;</span><span class=p>,</span> <span class=s2>&#34;k&#34;</span><span class=p>,</span> <span class=s2>&#34;l&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;B&#34;</span><span class=p>:</span> <span class=p>[</span><span class=mi>78</span><span class=p>,</span> <span class=mi>47</span><span class=p>,</span> <span class=mi>90</span><span class=p>,</span> <span class=mi>81</span><span class=p>,</span> <span class=mi>46</span><span class=p>,</span> <span class=mi>79</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><p><img class=lazyload src=/svg/loading.min.svg data-src=https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223438.png data-srcset="https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223438.png, https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223438.png 1.5x, https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223438.png 2x" data-sizes=auto alt=https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223438.png title=https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223438.png></p><p>这时候需要将这两个表进行合并，很显然是进行上下合并的，这时候我们就需要使用<code>concat</code>函数进行合并</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>pd</span><span class=o>.</span><span class=n>concat</span><span class=p>([</span><span class=n>df1</span><span class=p>,</span> <span class=n>df2</span><span class=p>])</span>
</span></span></code></pre></td></tr></table></div></div><p><img class=lazyload src=/svg/loading.min.svg data-src=https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223454.png data-srcset="https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223454.png, https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223454.png 1.5x, https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223454.png 2x" data-sizes=auto alt=https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223454.png title=https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223454.png></p><p><code>concat</code>函数默认是在纵向进行合并，但是合并之后发现有一个问题，<code>index</code>的顺序是不对的，在我们纵向合并表格的时候并不会有什么影响，但是这个问题在一些情况下是需要解决的，关于索引的问题后面会讲解。</p><h4 id=横向合并>横向合并</h4><p>有时候我们需要<strong>按索引</strong>横向合并两个表格的数据</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pandas</span> <span class=k>as</span> <span class=nn>pd</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>df1</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;A&#34;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;B&#34;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>df2</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;C&#34;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;D&#34;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><p><img class=lazyload src=/svg/loading.min.svg data-src=https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223523.png data-srcset="https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223523.png, https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223523.png 1.5x, https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223523.png 2x" data-sizes=auto alt=https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223523.png title=https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223523.png></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>pd</span><span class=o>.</span><span class=n>concat</span><span class=p>([</span><span class=n>df1</span><span class=p>,</span> <span class=n>df2</span><span class=p>],</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><img class=lazyload src=/svg/loading.min.svg data-src=https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223538.png data-srcset="https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223538.png, https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223538.png 1.5x, https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223538.png 2x" data-sizes=auto alt=https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223538.png title=https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223538.png></p><p>此时是在索引相同的情况，如果索引不同呢？有时候需要合并的数据是我们筛选出来的时候，不同的表格的索引大概率就是不同的</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pandas</span> <span class=k>as</span> <span class=nn>pd</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>df1</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;A&#34;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;B&#34;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>df2</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;C&#34;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;D&#34;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=n>index</span><span class=o>=</span><span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>7</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><img class=lazyload src=/svg/loading.min.svg data-src=https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223554.png data-srcset="https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223554.png, https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223554.png 1.5x, https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223554.png 2x" data-sizes=auto alt=https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223554.png title=https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223554.png></p><p>再次用<code>concat</code>合并表格</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>pd</span><span class=o>.</span><span class=n>concat</span><span class=p>([</span><span class=n>df1</span><span class=p>,</span> <span class=n>df2</span><span class=p>],</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><img class=lazyload src=/svg/loading.min.svg data-src=https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223609.png data-srcset="https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223609.png, https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223609.png 1.5x, https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223609.png 2x" data-sizes=auto alt=https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223609.png title=https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223609.png></p><p>那么这时候表格就错位了，此时我们可以通过<code>重置索引的方式解决</code></p><ol><li><p>赋值index属性</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>df2</span><span class=o>.</span><span class=n>index</span> <span class=o>=</span> <span class=nb>range</span><span class=p>(</span><span class=n>df2</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>reset_index方法重置索引。reset_index方法有一个<code>drop</code>参数，表示是否删除原索引，默认为False，如果是False那么原来的索引将会并入DataFrame中</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>df2</span><span class=o>.</span><span class=n>reset_index</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>df2</span><span class=o>.</span><span class=n>reset_index</span><span class=p>(</span><span class=n>drop</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><img class=lazyload src=/svg/loading.min.svg data-src=https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223630.png data-srcset="https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223630.png, https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223630.png 1.5x, https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223630.png 2x" data-sizes=auto alt=https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223630.png title=https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223630.png></p><p>上面重置索引的两种方法已经能够解决绝绝大部分问题，至于其他设置索引的方法就不介绍了，笔者常用方法就这两种</p><p><strong>注意：concat用来合并DataFrame和Series都是可以的，而且合并对象中的元素并不是只能两个，这里就不过多讲解</strong></p></li></ol><h2 id=append>append</h2><p>append的用法就比较简单了，大多数情况下是用来像原有的表中追加数据的，这个追加只能是纵向的追加，因为<code>DataFrame</code>的结构定位是类似于关系型数据库的纵向表格（当然有的时候也会横向进行操作）</p><p>使用<code>concat</code>中追加成绩的案例</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pandas</span> <span class=k>as</span> <span class=nn>pd</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>df1</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;A&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;a&#34;</span><span class=p>,</span> <span class=s2>&#34;b&#34;</span><span class=p>,</span> <span class=s2>&#34;c&#34;</span><span class=p>,</span> <span class=s2>&#34;d&#34;</span><span class=p>,</span> <span class=s2>&#34;e&#34;</span><span class=p>,</span> <span class=s2>&#34;f&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;B&#34;</span><span class=p>:</span> <span class=p>[</span><span class=mi>56</span><span class=p>,</span> <span class=mi>18</span><span class=p>,</span> <span class=mi>67</span><span class=p>,</span> <span class=mi>98</span><span class=p>,</span> <span class=mi>66</span><span class=p>,</span> <span class=mi>82</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>df2</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;A&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;g&#34;</span><span class=p>,</span> <span class=s2>&#34;h&#34;</span><span class=p>,</span> <span class=s2>&#34;i&#34;</span><span class=p>,</span> <span class=s2>&#34;j&#34;</span><span class=p>,</span> <span class=s2>&#34;k&#34;</span><span class=p>,</span> <span class=s2>&#34;l&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;B&#34;</span><span class=p>:</span> <span class=p>[</span><span class=mi>78</span><span class=p>,</span> <span class=mi>47</span><span class=p>,</span> <span class=mi>90</span><span class=p>,</span> <span class=mi>81</span><span class=p>,</span> <span class=mi>46</span><span class=p>,</span> <span class=mi>79</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>df1</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>df2</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>如果要重置索引，可以直接设置<code>ignore_index</code>参数的值为True</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>df1</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>df2</span><span class=p>,</span> <span class=n>ignore_index</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><img class=lazyload src=/svg/loading.min.svg data-src=https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223647.png data-srcset="https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223647.png, https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223647.png 1.5x, https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223647.png 2x" data-sizes=auto alt=https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223647.png title=https://pujichun-blog-1301170821.cos.ap-chengdu.myqcloud.com/img/20220405223647.png></p><h2 id=总结>总结</h2><ul><li>merge：需要按照某列或者多列进行合并的时候使用</li><li>concat：需要简单粗暴的进行合并的时候使用（最常用）</li><li>append：只适用于追加数据的时候使用（不常用，大多数情况还是使用concat）</li></ul></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>更新于 2021-03-09</span></div><div class=post-info-license></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=/tags/%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86/>数据处理</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/>主页</a></span></section></div><div class=post-nav><a href=/posts/pandas%E8%AF%BB%E5%8F%96%E5%A4%A7%E6%96%87%E4%BB%B6%E7%AD%9B%E9%80%89%E6%95%B0%E6%8D%AE/ class=prev rel=prev title=pandas读取大文件筛选数据><i class="fas fa-angle-left fa-fw"></i>pandas读取大文件筛选数据</a>
<a href=/posts/pandas%E6%95%B0%E6%8D%AE%E8%81%9A%E5%90%88/ class=next rel=next title=pandas数据分组聚合>pandas数据分组聚合<i class="fas fa-angle-right fa-fw"></i></a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2019 - 2023</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=http://pujichun.ink target=_blank>普吉春</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title=回到顶部><i class="fas fa-arrow-up fa-fw"></i>
</a><a href=# id=view-comments class=fixed-button title=查看评论><i class="fas fa-comment fa-fw"></i></a></div><script type=text/javascript src=/lib/smooth-scroll/smooth-scroll.min.js></script><script type=text/javascript src=/lib/autocomplete/autocomplete.min.js></script><script type=text/javascript src=/lib/lunr/lunr.min.js></script><script type=text/javascript src=/lib/lunr/lunr.stemmer.support.min.js></script><script type=text/javascript src=/lib/lunr/lunr.zh.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript src=/lib/typeit/typeit.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"复制到剪贴板",maxShownLines:10},comment:{},data:{"id-1":"pujic","id-2":"pujic"},search:{highlightTag:"em",lunrIndexURL:"/index.json",lunrLanguageCode:"zh",lunrSegmentitURL:"/lib/lunr/lunr.segmentit.js",maxResultLength:10,noResultsFound:"没有找到结果",snippetLength:50,type:"lunr"},typeit:{cursorChar:null,cursorSpeed:null,data:{"id-1":["id-1"],"id-2":["id-2"]},duration:null,speed:null}}</script><script type=text/javascript src=/js/theme.min.js></script></body></html>